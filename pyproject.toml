[build-system]
requires = ["poetry-core>=1.0.0"]
build-backend = "poetry.core.masonry.api"

[tool.black]
include = '\.pyi?$'
exclude = '''
/(
    \.git
  | \.hg
  | \.mypy_cache
  | \.tox
  | \.venv
  | _build
  | buck-out
  | build
  | dist
)/
'''

[tool.coverage.run]
data_file = ".cov/.coverage"
source = ["robotoff"]

[tool.coverage.xml]
output = ".cov/coverage.xml"

[tool.isort] # From https://black.readthedocs.io/en/stable/compatible_configs.html#isort
multi_line_output = 3
include_trailing_comma = true
force_grid_wrap = 0
use_parentheses = true
ensure_newline_before_comments = true
line_length = 88

[tool.poetry]
name = "robotoff"
version = "1.1.0"
description = "Real-time and batch prediction service for Openfoodfacts."
authors = ["Openfoodfacts Team"]
license = "GNU Affero General Public License v3"

[tool.poetry.dependencies]
python = "^3.7"
requests = "~2.26.0"
peewee = "~3.14.4"
psycopg2-binary = "~2.9.1"
gunicorn = "~20.1.0"
falcon = "~2.0.0"
falcon-cors = "~1.1.7"
falcon-multipart = "~0.2.0"
elasticsearch = "~7.14.1"
pymongo = "~3.12.0"
spacy = "~2.3.7"
dacite = "~1.6.0"
flashtext = "~2.7"
langid = "~1.1.6"
influxdb = "~5.3.1"
jsonschema = "~3.2.0"
orjson = "~3.6.3"
Pillow = "~8.3.2"
numpy = "~1.19.5"
protobuf = "~3.17.3"
Pint = "0.9"
APScheduler = "~3.7.0"
more-itertools = "~8.9.0"
scikit-learn = "~0.24.2"
matplotlib = "~3.4.3"
scipy = "~1.6.1"
typer = "~0.3.2"
py-healthcheck = "^1.10.1"

[tool.poetry.dependencies.sentry-sdk]
version = "~0.19.5"
extras = ["falcon"]

[tool.poetry.dev-dependencies]
flake8 = "3.9.2"
black = "20.8b1"
mypy = "0.790"
pytest = "~6.2.5"
pytest-mock = "~3.6.1"
pre-commit = "~2.15.0"
toml-sort = "~0.18.0"
isort = "~5.9.3"
flake8-bugbear = "~21.9.1"
flake8-github-actions = "~0.1.1"
pytest-cov = "~2.12.1"
mkdocs-material = "~7.2.3"
mdx-truly-sane-lists = "~1.2"
mkdocs-awesome-pages-plugin = "~2.5.0"
typer-cli = "~0.0.11"
coverage = {extras = ["toml"], version = "~6.2"}

[tool.poetry.scripts]
robotoff-cli = 'robotoff.cli.main:main'
